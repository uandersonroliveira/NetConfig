<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NetConfig - Network Switch Manager</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <span class="icon">&#128268;</span>
                <h1>NetConfig</h1>
            </div>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#" data-page="dashboard" class="active">&#128202; Dashboard</a></li>
                    <li><a href="#" data-page="devices">&#128421; Devices</a></li>
                    <li><a href="#" data-page="scan">&#128269; Scan Network</a></li>
                    <li><a href="#" data-page="collect">&#128230; Collect Configs</a></li>
                    <li><a href="#" data-page="logs">&#128220; Collect Logs</a></li>
                    <li><a href="#" data-page="compare">&#128203; Compare</a></li>
                    <li><a href="#" data-page="reports">&#128196; Reports</a></li>
                    <li><a href="#" data-page="mac-search">&#128279; MAC Search</a></li>
                    <li><a href="#" data-page="credentials">&#128274; Credentials</a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Page -->
            <div id="page-dashboard" class="page-view active">
                <div class="page-header">
                    <h2>Dashboard</h2>
                </div>
                <div class="stats-grid">
                    <div class="stat-card primary">
                        <div class="stat-value" id="stat-total-devices">0</div>
                        <div class="stat-label">Total Devices</div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-value" id="stat-online">0</div>
                        <div class="stat-label">Online</div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-value" id="stat-offline">0</div>
                        <div class="stat-label">Offline</div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-value" id="stat-credentials">0</div>
                        <div class="stat-label">Credentials</div>
                    </div>
                </div>
            </div>

            <!-- Devices Page -->
            <div id="page-devices" class="page-view">
                <div class="page-header">
                    <h2>Devices</h2>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-danger" id="bulk-delete-btn" onclick="bulkDeleteDevices()" style="display: none;">
                            &#128465; Delete Selected (<span id="selected-count">0</span>)
                        </button>
                        <button class="btn btn-secondary" onclick="checkDevicesStatus()">
                            &#8635; Update Status
                        </button>
                        <button class="btn btn-secondary" onclick="openCollectConfigsModal()">
                            &#128230; Collect Configs
                        </button>
                        <button class="btn btn-primary" onclick="openModal('add-device-modal')">
                            + Add Devices
                        </button>
                    </div>
                </div>

                <!-- Device Page Tabs -->
                <div class="tabs" id="devices-tabs">
                    <button class="tab-btn active" data-tab="devices-list-tab">All Devices</button>
                    <button class="tab-btn" data-tab="devices-groups-tab">Groups</button>
                </div>

                <!-- All Devices Tab -->
                <div id="devices-list-tab" class="tab-content active">
                    <div id="status_check-progress" class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">
                            <span>Checking status...</span>
                        </div>
                    </div>
                    <div id="devices-collect-progress" class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">
                            <span>Collecting configs...</span>
                        </div>
                    </div>
                    <div id="devices-collect-device-list" class="card" style="display: none; margin-bottom: 1rem;">
                        <div class="card-header" style="border-bottom: 1px solid var(--border-color); margin: -1.5rem -1.5rem 1rem -1.5rem; padding: 1rem 1.5rem;">
                            <span class="card-title">Collection Progress</span>
                        </div>
                        <div id="devices-collect-device-progress" class="device-progress-list" style="max-height: 200px; overflow-y: auto;"></div>
                    </div>
                    <div class="card">
                        <div class="selection-helpers">
                            <kbd>Shift</kbd>+Click for range | <kbd>Ctrl</kbd>+Click to toggle | <kbd>Ctrl</kbd>+<kbd>A</kbd> select all | Right-click for group actions
                        </div>
                        <div class="table-container">
                            <table id="devices-table">
                                <thead>
                                    <tr>
                                        <th style="width: 40px;">
                                            <input type="checkbox" id="select-all-devices" onchange="toggleSelectAll(this)">
                                        </th>
                                        <th>IP Address</th>
                                        <th>Hostname</th>
                                        <th>Vendor</th>
                                        <th>Status</th>
                                        <th>Model</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="devices-tbody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Groups Tab -->
                <div id="devices-groups-tab" class="tab-content">
                    <div class="groups-header">
                        <h3>Device Groups</h3>
                        <button class="btn btn-primary" onclick="openCreateGroupModal()">
                            + Create Group
                        </button>
                    </div>
                    <div id="groups-list" class="groups-grid">
                        <div class="groups-empty">
                            <div class="groups-empty-icon">&#128193;</div>
                            <p>No groups created yet</p>
                            <button class="btn btn-primary" onclick="openCreateGroupModal()">Create Your First Group</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Scan Page -->
            <div id="page-scan" class="page-view">
                <div class="page-header">
                    <h2>Scan Network</h2>
                </div>
                <div class="card">
                    <h3 style="margin-bottom: 1rem;">IP Range Scan</h3>
                    <form id="scan-form">
                        <div class="form-group">
                            <label for="scan-ip-range">IP Range</label>
                            <input type="text" id="scan-ip-range" class="form-control"
                                   placeholder="192.168.1.0/24 or 192.168.1.1-50" required>
                            <small style="color: var(--text-muted);">
                                Supports CIDR notation (192.168.1.0/24) or range (192.168.1.1-50)
                            </small>
                        </div>
                        <button type="submit" class="btn btn-primary" id="scan-btn">Start Scan</button>
                    </form>
                    <div id="scan-progress" class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">
                            <span>Starting...</span>
                        </div>
                    </div>

                    <!-- Scan Results Selection -->
                    <div id="scan-results" style="display: none; margin-top: 1.5rem;">
                        <h4>Discovered Devices</h4>
                        <p style="color: var(--text-muted); margin-bottom: 0.5rem;">
                            Select devices to add to your inventory:
                        </p>
                        <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                            <table>
                                <thead>
                                    <tr>
                                        <th style="width: 40px;">
                                            <input type="checkbox" id="scan-select-all" onchange="toggleScanSelectAll(this)">
                                        </th>
                                        <th>IP Address</th>
                                        <th>Response Time</th>
                                        <th>Vendor</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="scan-results-tbody"></tbody>
                            </table>
                        </div>
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem; align-items: center;">
                            <button class="btn btn-primary" id="add-scanned-devices-btn" onclick="addSelectedScannedDevices()">
                                Add Selected (<span id="scan-selected-count">0</span>)
                            </button>
                            <button class="btn btn-secondary" onclick="clearScanResults()">Clear Results</button>
                        </div>
                    </div>
                </div>

                <div class="card" style="margin-top: 1rem;">
                    <h3 style="margin-bottom: 1rem;">LLDP/CDP Discovery</h3>
                    <p style="color: var(--text-muted); margin-bottom: 1rem;">
                        Discover network neighbors by querying LLDP/CDP from devices.
                    </p>
                    <form id="discover-form">
                        <div class="form-group">
                            <label for="discover-ip-range">IP Range (optional)</label>
                            <input type="text" id="discover-ip-range" class="form-control"
                                   placeholder="192.168.1.0/24 or 192.168.1.1-50 (leave empty to use known devices)">
                            <small style="color: var(--text-muted);">
                                If provided, scans the range first, detects vendors, then discovers neighbors
                            </small>
                        </div>
                        <div class="form-group">
                            <label for="discover-credential">Credential</label>
                            <select id="discover-credential" class="form-control credential-select">
                                <option value="">Use Default</option>
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary" id="discover-btn">Start Discovery</button>
                    </form>
                    <div id="discover-progress" class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">
                            <span>Starting...</span>
                        </div>
                    </div>
                    <div id="discover-device-list" style="margin-top: 1rem; display: none;">
                        <h4>Devices Being Queried:</h4>
                        <div id="discover-device-progress" class="device-progress-list"></div>
                    </div>
                    <div id="discover-results" style="margin-top: 1rem; display: none;">
                        <h4>Discovered Neighbors:</h4>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Neighbor Device</th>
                                        <th>Source Device</th>
                                        <th>Protocol</th>
                                        <th>Local Interface</th>
                                        <th>Remote Interface</th>
                                        <th>Detected Vendor</th>
                                    </tr>
                                </thead>
                                <tbody id="discover-results-tbody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Collect Page -->
            <div id="page-collect" class="page-view">
                <div class="page-header">
                    <h2>Collection</h2>
                </div>
                <div class="card">
                    <form id="collect-form">
                        <div class="form-group">
                            <label for="collect-credential">Credential</label>
                            <select id="collect-credential" class="form-control credential-select">
                                <option value="">Use Default</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="collect-all" checked> Collect from all devices
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary">Start Collection</button>
                    </form>
                    <div id="collect-progress" class="progress-container" style="display: none;">
                        <div class="progress-bar">
                            <div class="progress-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">
                            <span>Starting...</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Log Collection Page -->
            <div id="page-logs" class="page-view">
                <div class="page-header">
                    <h2>Log Collection</h2>
                </div>
                <div class="card">
                    <form id="logs-form">
                        <div class="form-group">
                            <label for="logs-credential">Credential</label>
                            <select id="logs-credential" class="form-control credential-select">
                                <option value="">Use Default</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Select devices to collect logs from:</label>
                            <div id="logs-device-list" class="card" style="max-height: 300px; overflow-y: auto; padding: 0.75rem; margin-top: 0.5rem;">
                                <p class="empty-state" style="padding: 1rem;">Loading devices...</p>
                            </div>
                            <div style="margin-top: 0.5rem;">
                                <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllLogDevices(true)">Select All</button>
                                <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllLogDevices(false)">Select None</button>
                                <span id="logs-selected-count" style="margin-left: 1rem; color: var(--text-muted);">0 selected</span>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="logs-collect-btn">Start Log Collection</button>
                    </form>
                    <div id="logs-progress" class="progress-container" style="display: none; margin-top: 1rem;">
                        <div class="progress-bar">
                            <div class="progress-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">
                            <span>Starting...</span>
                        </div>
                    </div>
                </div>
                <div id="logs-device-progress" class="card" style="margin-top: 1rem; display: none;">
                    <div class="card-header" style="border-bottom: 1px solid var(--border-color); margin: -1.5rem -1.5rem 1rem -1.5rem; padding: 1rem 1.5rem;">
                        <span class="card-title">Collection Progress</span>
                    </div>
                    <div id="logs-device-status-list" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
                <div id="logs-results" class="card" style="margin-top: 1rem; display: none;">
                    <div class="card-header" style="border-bottom: 1px solid var(--border-color); margin: -1.5rem -1.5rem 1rem -1.5rem; padding: 1rem 1.5rem;">
                        <span class="card-title">Collected Logs</span>
                    </div>
                    <div id="logs-results-list"></div>
                </div>
            </div>

            <!-- Compare Page -->
            <div id="page-compare" class="page-view">
                <div class="page-header">
                    <h2>Compare Configurations</h2>
                </div>
                <div class="card">
                    <div class="form-group">
                        <label for="compare-reference">Reference Device (baseline)</label>
                        <select id="compare-reference" class="form-control">
                            <option value="">Select reference device...</option>
                        </select>
                        <small style="color: var(--text-muted);">This device's configuration will be used as the baseline for comparison</small>
                    </div>
                    <div class="form-group">
                        <label>Target Devices (to compare with reference)</label>
                        <div id="compare-targets-list" class="card" style="max-height: 250px; overflow-y: auto; padding: 0.75rem; margin-top: 0.5rem;">
                            <p class="empty-state" style="padding: 1rem;">Select a reference device first</p>
                        </div>
                        <div style="margin-top: 0.5rem;">
                            <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllCompareTargets(true)">Select All</button>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllCompareTargets(false)">Select None</button>
                            <span id="compare-selected-count" style="margin-left: 1rem; color: var(--text-muted);">0 selected</span>
                        </div>
                    </div>
                    <div style="margin-top: 1rem;">
                        <button type="button" class="btn btn-primary" onclick="startBatchComparison()" id="start-compare-btn" disabled>
                            Start Comparison
                        </button>
                    </div>
                </div>
                <div id="compare-progress" class="progress-container" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-bar-fill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text">
                        <span>Comparing...</span>
                    </div>
                </div>
                <div id="compare-complete" class="card" style="display: none; margin-top: 1rem;">
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div>
                            <h4 style="margin-bottom: 0.25rem;">Comparison Complete</h4>
                            <p id="compare-complete-summary" style="color: var(--text-muted); margin: 0;"></p>
                        </div>
                        <button class="btn btn-primary" onclick="viewComparisonReport()">
                            View Report
                        </button>
                    </div>
                </div>
            </div>

            <!-- Reports Page -->
            <div id="page-reports" class="page-view">
                <div class="page-header">
                    <h2>Reports</h2>
                </div>
                <div class="tabs">
                    <button class="tab-btn active" data-tab="comparison-reports">Comparison Reports</button>
                </div>
                <div id="tab-comparison-reports" class="tab-content active">
                    <div class="card">
                        <div class="card-header">
                            <span class="card-title">Recent Comparisons</span>
                        </div>
                        <div id="comparison-reports-list">
                            <p class="empty-state">No comparison reports yet. Run a comparison from the Compare page.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- MAC Search Page -->
            <div id="page-mac-search" class="page-view">
                <div class="page-header">
                    <h2>MAC Address Search</h2>
                </div>
                <div class="card">
                    <form id="mac-search-form">
                        <div class="form-group">
                            <label for="mac-address">MAC Address</label>
                            <input type="text" id="mac-address" class="form-control"
                                   placeholder="00:11:22:33:44:55 or 00:11:22:* (wildcard)" required>
                            <small style="color: var(--text-muted);">
                                Supports wildcards: <code>*</code> matches any sequence, <code>?</code> matches single character.<br>
                                Examples: <code>00:11:22:*</code>, <code>00:11:??:33:*</code>, <code>0011*</code>
                            </small>
                        </div>
                        <div class="form-group">
                            <label for="mac-search-credential">Credential</label>
                            <select id="mac-search-credential" class="form-control credential-select">
                                <option value="">Use Default</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Select devices to search:</label>
                            <div id="mac-search-device-list" style="max-height: 200px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 4px; padding: 0.5rem; margin-top: 0.5rem;">
                                <p class="empty-state">Loading devices...</p>
                            </div>
                            <div style="margin-top: 0.5rem;">
                                <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllMacSearchDevices(true)">Select All</button>
                                <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllMacSearchDevices(false)">Select None</button>
                                <span id="mac-search-selected-count" style="margin-left: 1rem; color: var(--text-muted);">0 selected</span>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="mac-search-btn">Search</button>
                    </form>
                    <div id="mac_search-progress" class="progress-container" style="display: none; margin-top: 1rem;">
                        <div class="progress-bar">
                            <div class="progress-bar-fill" style="width: 0%"></div>
                        </div>
                        <div class="progress-text">
                            <span>Searching devices...</span>
                        </div>
                    </div>
                </div>
                <div id="mac-device-progress" class="card" style="margin-top: 1rem; display: none;">
                    <div class="card-header" style="border-bottom: 1px solid var(--border-color); margin: -1.5rem -1.5rem 1rem -1.5rem; padding: 1rem 1.5rem;">
                        <span class="card-title">Scanning Devices</span>
                    </div>
                    <div id="mac-device-list" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
                <div id="mac-results" class="card" style="margin-top: 1rem; display: none;"></div>
            </div>

            <!-- Credentials Page -->
            <div id="page-credentials" class="page-view">
                <div class="page-header">
                    <h2>Credentials</h2>
                    <button class="btn btn-primary" onclick="openModal('add-credential-modal')">
                        + Add Credential
                    </button>
                </div>
                <div class="card">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>Username</th>
                                    <th>Description</th>
                                    <th>Default</th>
                                    <th>Created</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="credentials-tbody">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Add Device Modal -->
    <div id="add-device-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3>Add Devices</h3>
                <button class="modal-close" onclick="closeModal('add-device-modal')">&times;</button>
            </div>
            <form id="add-device-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="device-ips">IP Addresses</label>
                        <textarea name="ips" id="device-ips" class="form-control" rows="4"
                                  placeholder="Enter IPs, ranges, or CIDR notation&#10;Examples: 192.168.1.1, 192.168.1.10-20, 192.168.2.0/24" required></textarea>
                        <small style="color: var(--text-muted);">
                            Supports: single IPs, ranges (192.168.1.1-10), CIDR (192.168.1.0/24)
                        </small>
                    </div>
                    <div class="form-group">
                        <label for="device-vendor">Vendor</label>
                        <select name="vendor" id="device-vendor" class="form-control">
                            <option value="">Auto-detect</option>
                            <option value="huawei">Huawei</option>
                            <option value="hp">HP</option>
                            <option value="aruba">Aruba</option>
                            <option value="cisco">Cisco (IOS)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="device-credential">Credential</label>
                        <select name="credential_id" id="device-credential" class="form-control credential-select">
                            <option value="">Use Default</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('add-device-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Devices</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Credential Modal -->
    <div id="add-credential-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3>Add Credential</h3>
                <button class="modal-close" onclick="closeModal('add-credential-modal')">&times;</button>
            </div>
            <form id="add-credential-form">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="cred-username">Username</label>
                        <input type="text" name="username" id="cred-username" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="cred-password">Password</label>
                        <input type="password" name="password" id="cred-password" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="cred-description">Description (optional)</label>
                        <input type="text" name="description" id="cred-description" class="form-control"
                               placeholder="e.g., Admin account for switches">
                    </div>
                    <div class="form-group">
                        <label>
                            <input type="checkbox" name="is_default" id="cred-default">
                            Set as default credential
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('add-credential-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary">Add Credential</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Config Viewer Modal -->
    <div id="config-viewer-modal" class="modal-overlay">
        <div class="modal" style="max-width: 900px;">
            <div class="modal-header">
                <h3>Configuration: <span id="config-device-ip"></span></h3>
                <button class="modal-close" onclick="closeModal('config-viewer-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <pre class="config-viewer" id="config-viewer-content"></pre>
            </div>
        </div>
    </div>

    <!-- Collect Configs Modal -->
    <div id="collect-configs-modal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3>Collect Configurations</h3>
                <button class="modal-close" onclick="closeModal('collect-configs-modal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="collect-modal-credential">Credential</label>
                    <select id="collect-modal-credential" class="form-control credential-select">
                        <option value="">Use Default</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Select devices to collect from:</label>
                    <div id="collect-modal-device-list" style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 4px; padding: 0.5rem; margin-top: 0.5rem;">
                        <p class="empty-state">Loading devices...</p>
                    </div>
                    <div style="margin-top: 0.5rem;">
                        <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllCollectDevices(true)">Select All</button>
                        <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllCollectDevices(false)">Select None</button>
                        <span id="collect-modal-selected-count" style="margin-left: 1rem; color: var(--text-muted);">0 selected</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closeModal('collect-configs-modal')">Cancel</button>
                <button type="button" class="btn btn-primary" id="collect-modal-btn" onclick="startCollectFromModal()">
                    Start Collection
                </button>
            </div>
        </div>
    </div>

    <!-- Create/Edit Group Modal -->
    <div id="group-modal" class="modal-overlay">
        <div class="modal" style="max-width: 600px;">
            <div class="modal-header">
                <h3 id="group-modal-title">Create Group</h3>
                <button class="modal-close" onclick="closeModal('group-modal')">&times;</button>
            </div>
            <form id="group-form">
                <input type="hidden" id="group-id" value="">
                <div class="modal-body">
                    <div class="form-group">
                        <label for="group-name">Group Name</label>
                        <input type="text" id="group-name" class="form-control" placeholder="e.g., Core Switches" required>
                    </div>
                    <div class="form-group">
                        <label for="group-description">Description</label>
                        <textarea id="group-description" class="form-control" rows="2" placeholder="Optional description for this group"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="group-color">Color</label>
                        <div class="color-picker">
                            <input type="color" id="group-color" value="#3b82f6">
                            <span class="color-preview" id="color-preview">Blue</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Select Devices</label>
                        <div id="group-device-selection" class="device-selection-container">
                            <p class="empty-state" style="padding: 1rem;">Loading devices...</p>
                        </div>
                        <div style="margin-top: 0.5rem; display: flex; align-items: center; gap: 0.5rem;">
                            <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllGroupDevices(true)">Select All</button>
                            <button type="button" class="btn btn-sm btn-secondary" onclick="selectAllGroupDevices(false)">Select None</button>
                            <span id="group-device-count" style="margin-left: auto; color: var(--text-muted);">0 selected</span>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('group-modal')">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="group-submit-btn">Create Group</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Scripts -->
    <script src="/static/js/api.js"></script>
    <script src="/static/js/websocket.js"></script>
    <script src="/static/js/selection.js"></script>
    <script src="/static/js/context-menu.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
